---
title: "[Transcriptome] RNA-sequencing"
excerpt: "RNA-seq을 마스터해보자."

categories: 
    - Bioinformatics
    - Sequencing
last_modified_at: 2020-10-17T08:06:00-05:00
---

## What is RNA-seq?

RNA seq은 말 그대로 RNA sequencing을 의미한다.  
이를 통해 1) gene expression level, 2) non-coding RNA, 3) Isoforms, 4) Fusion genes 등에 대해 알 수 있다.  
즉, **RNA**를 가지고, **RNA의 발현에 관한 내용**을 알고싶다면 여기에 나온 과정이 도움이 될 것이다.

## RNA prep kit
관심있는 대상에 따라 사용하는 kit가 달라진다.
1. TruSeq mRNA Library Prep Kit : mRNA 만 prep  
    1) poly A tail을 기준으로 RNA detect
    2) RNA를 조각내고, primer를 붙임
    3) fragmented RNA를 우선 cDNA로 합성 : RNA-DNA 결합
    4) 역전사효소를 이용해서 cDNA로 합성 : DNA-DNA 결합  
2. TruSeq Total RNA Library Prep Kit : rRNA를 포함한 모든 RNA prep
3. TruSeq Stranded mRNA Library Prep Kit : forward, reverse 중 어디를 기준으로 발현을 하는 건지 알고싶을 때 사용

## Workflow
**tool 마다 필요한 input이 다르고, 나오는 output이 다르다**  

**1. Library construction & NGS sequencing**  
우선 준비한 library(sample = RNA)를 sequencing 기계를 이용해서 fastq 파일로 만든다.  
주로 이 과정은 회사들을 통해서 진행된다.

**2. Sequencing Read Quality Check**  
sequencing을 하면 read들을 하나씩 읽게 된다.  
이렇게 읽은 read들의 quality를 check 하는 과정
* tool : fastqc
* input : sample_1.fastq.gz(fwd), sample_2.fastq.gz(rev)
* output : [D]sample_1_fastqc, sample_1_fastqc.zip, **sample_1_fastqc.html**, [D]sample_2_fastqc, sample_2_fastqc.zip, **sample_2_fastqc.html**

html 파일을 이용해서 Quality Check의 결과를 확인한다.  
주로 확인하는 내용은 4가지이다.
* Base Quality : 전체적인 quality check
* Per Sequence GC Content  
GC 비율이 많으면 poly A tail이 많게 실험이 이뤄진 경우,  
GC 비율이 적으면 rRNA가 많은 경우로 rRNA removal 작업이 추가로 필요할 수 있다.
* Sequence Duplication Levels
* Adapt Content : adapter 양이 얼마나 있는지 확인한다.   
(보통 아래 3번 수행 후 다시 QC를 해보면 그래프가 바닥에 깔려있는 것을 확인할 수 있다.)


**3. Cut Adapter & Trimming**  
앞에 quality check의 결과로 확인한 quality가 떨어지는 read들은 제거하고, 남은 reads에서 sequencing 과정을 위해 들어간 adapter 부분을 제거한다.  
* tool : trimmomatic
* input : sample_1.fastq.gz, sample_2.fastq.gz
* output : sample_1_cutadapt.fastq.gz, sample_2_cutadapt.fastq.gz

**4. Reference Mapping**  
3까지의 과정으로 quality가 어느 정도 괜찮은 read들만 남아있을테니, 이들을 reference에 붙여서 read들의 위치를 확인해준다.  
사실상 여기까지의 과정은 앞에 정말 기계로 읽은 sequencing 데이터를 분석에 사용할 수 있는 data로 만들어주는 과정이다.  
그래서, 다른 sequencing이나 분석의 과정에서도 똑같이 적용된다. 
* tool : STAR
* input : reference file, sample_1_cutadapt.fastq.gz, sample_2_cutadapt.fastq.gz (3의 결과로 나온 파일들)
* output : 총 6가지  
sample.Aligned.sortedByCoord.out.bam (Genome mapping 결과)  
sample.Aligned.toTranscriptome.out.bam (Transcriptome mapping 결과)  
sample.log.final.out / sample.log.out / sample.log.progress.out / sample.SJ.out.tab (잘 모르겠다...)  
  
**5. Calculate Expression**  
어떤 gene이 얼만큼 발현되었는지를 알아보기 위한 과정이다.  